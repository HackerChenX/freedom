# 可配置选股系统应用指南

## 1. 配置文件示例

### 1.1 指标配置文件
```yaml
# config/indicators_config.yaml
indicators:
  MA_CROSS:
    id: MA_CROSS
    name: 均线交叉
    category: TREND
    description: 快速均线与慢速均线交叉产生的买卖信号
    parameters:
      fast_period:
        default: 5
        min: 3
        max: 50
        description: 快速均线周期
      slow_period:
        default: 20
        min: 10
        max: 200
        description: 慢速均线周期
  
  KDJ:
    id: KDJ
    name: KDJ随机指标
    category: OSCILLATOR
    description: 基于价格波动范围的超买超卖指标
    parameters:
      n:
        default: 9
        min: 3
        max: 50
        description: RSV计算周期
      m1:
        default: 3
        min: 1
        max: 10
        description: K值平滑因子
      m2:
        default: 3
        min: 1
        max: 10
        description: D值平滑因子
  
  VOLUME_SURGE:
    id: VOLUME_SURGE
    name: 成交量放大
    category: VOLUME
    description: 检测成交量异常放大的指标
    parameters:
      n:
        default: 5
        min: 3
        max: 20
        description: 对比周期
      threshold:
        default: 2.0
        min: 1.2
        max: 5.0
        description: 放量阈值
```

### 1.2 策略配置文件
```yaml
# config/strategies/trend_reversal.yaml
name: 趋势反转策略
description: 寻找日线级别反转、同时具备中长期向上趋势的股票
conditions:
  - indicator: MA_CROSS
    period: daily
    parameters:
      fast_period: 5
      slow_period: 10
    required: true
    weight: 1.0
  
  - indicator: KDJ
    period: daily
    parameters:
      n: 9
      m1: 3
      m2: 3
    required: false
    weight: 0.8
  
  - logic: AND
  
  - indicator: MA_CROSS
    period: weekly
    parameters:
      fast_period: 5
      slow_period: 20
    required: false
    weight: 1.2
  
  - logic: OR
  
  - indicator: VOLUME_SURGE
    period: daily
    parameters:
      n: 5
      threshold: 2.0
    required: false
    weight: 0.5
  
  - logic: AND

filters:
  markets:
    - 主板
    - 创业板
    - 科创板
  industries: []  # 空列表表示不过滤行业
  min_market_cap: 50  # 最小市值（亿元）
  max_market_cap: 2000  # 最大市值（亿元）
  price_min: 5.0  # 最低股价
  price_max: 200.0  # 最高股价

result_sorting:
  - field: signal_strength
    order: DESC
  - field: market_cap
    order: ASC

max_stocks: 100  # 最多返回100只股票
```

## 2. 使用示例

### 2.1 命令行调用
```bash
# 使用指定策略选股
python bin/stock_select.py --strategy trend_reversal

# 使用指定策略选股，并指定日期
python bin/stock_select.py --strategy trend_reversal --date 2023-05-15

# 使用自定义配置文件
python bin/stock_select.py --config /path/to/my_strategy.yaml

# 使用指定股票池
python bin/stock_select.py --strategy trend_reversal --pool /path/to/my_stocks.txt

# 输出详细日志
python bin/stock_select.py --strategy trend_reversal --verbose
```

### 2.2 API调用
```python
from strategy.strategy_factory import StrategyFactory
from utils.date_utils import get_latest_trading_date
from utils.result_utils import save_results

# 加载策略
strategy = StrategyFactory.create("trend_reversal")

# 获取最新交易日期
date = get_latest_trading_date()

# 执行选股
results = strategy.select(date=date)

# 保存结果
save_results(results, "trend_reversal_results.csv")

# 打印结果摘要
print(f"选出 {len(results)} 只股票")
print(results[['stock_code', 'stock_name', 'signal_strength']].head(10))
```

## 3. 扩展性设计

本系统设计为高度可扩展的架构，支持以下几种主要的扩展方式：

### 3.1 新增指标
通过实现BaseIndicator接口，可以轻松添加新的技术指标：

1. 创建新的指标类，继承BaseIndicator
2. 实现calculate和generate_signals方法
3. 在indicators/__init__.py中注册新指标
4. 在indicators_config.yaml中添加指标配置

### 3.2 新增策略类型
如果默认策略不满足需求，可以实现自定义策略：

1. 创建新的策略类，继承BaseStrategy
2. 实现select方法
3. 在StrategyFactory中注册新策略

### 3.3 扩展过滤条件
系统支持灵活添加新的股票过滤条件：

1. 在DefaultStrategy._get_filtered_stock_pool方法中添加新的过滤逻辑
2. 在策略配置文件中添加相应的过滤条件配置

### 3.4 扩展结果处理
可以扩展结果处理功能：

1. 添加新的结果格式化方法
2. 实现自定义的结果分析功能
3. 添加结果可视化组件

## 4. 总结

本文档详细说明了可配置选股系统的应用方法，该系统具有以下特点：

1. **配置驱动**：通过YAML格式的配置文件定义选股策略，无需编写代码
2. **模块化设计**：系统划分为指标引擎、策略管理、数据访问等核心模块
3. **灵活组合**：支持多种指标、多种周期的灵活组合
4. **高扩展性**：易于添加新指标、新策略和新功能
5. **错误容忍**：提供完善的参数验证和异常处理
6. **性能优化**：实现数据缓存和并行处理提升性能

通过本系统，用户可以快速构建和测试各种技术指标驱动的选股策略，极大提高策略开发和测试的效率。系统与现有项目架构无缝集成，遵循项目规范，确保代码质量和可维护性。 