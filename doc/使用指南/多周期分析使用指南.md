# 多周期分析使用指南

## 概述

多周期分析是一种强大的技术分析方法，它通过同时分析多个时间周期的数据，帮助您发现更加可靠的交易信号。本系统支持分析以下时间周期：

- 15分钟线
- 30分钟线
- 60分钟线
- 日线
- 周线
- 月线

通过观察不同周期的技术指标表现，您可以更全面地了解股票的走势和潜在的买卖点。

## 快速开始

### 使用股票工作流

最简单的方式是使用集成的股票工作流，一键完成单周期和多周期分析：

```bash
python bin/stock_workflow.py --code 600585 --date 20250415 --multi-period
```

参数说明：
- `--code`: 股票代码，必填
- `--date`: 分析日期，格式为YYYYMMDD，必填
- `--multi-period`: 启用多周期分析，可选
- `--output-dir`: 指定输出目录，可选
- `--no-strategy`: 不生成选股策略，可选

### 单独使用多周期分析

如果您只想进行多周期分析，可以使用专门的多周期分析工具：

```bash
python bin/stock_multi_period.py --code 600585 --date 20250415
```

参数说明：
- `--code`: 股票代码，与`--csv`二选一
- `--date`: 分析日期，格式为YYYYMMDD，与`--code`一起使用
- `--csv`: 包含股票代码和日期的CSV文件路径，与`--code`二选一
- `--output-dir`: 指定输出目录，可选
- `--days-before`: 分析买点前几天的数据，默认20
- `--days-after`: 分析买点后几天的数据，默认10
- `--pattern-type`: 买点类型描述，可选

### 批量分析

如果需要批量分析多只股票，可以准备一个CSV文件，包含股票代码和日期列，然后使用以下命令：

```bash
python bin/stock_multi_period.py --csv 买点列表.csv
```

CSV文件格式示例：
```
code,date,pattern_type
600585,20250415,KDJ金叉
000001,20250416,MACD金叉
```

## 分析报告解读

### 多周期分析报告

多周期分析报告包含以下主要内容：

1. **各周期价格信息**：显示开盘价、最高价、最低价和收盘价
2. **技术指标**：包括MACD、KDJ、RSI和均线系统
3. **交易信号**：在各个周期检测到的交易信号
4. **跨周期共性**：多个周期共同具有的特征

### 跨周期信号的重要性

当多个时间周期同时出现相同的信号时，这通常是一个更为可靠的交易信号。例如：

- 日线和周线同时出现KDJ金叉
- 15分钟、60分钟和日线均处于超卖区域
- 所有周期均线系统呈多头排列

这些跨周期共性信号往往比单一周期的信号更加可靠。

## 常见场景分析

### 场景一：日线回调到支撑位

当日线回调到重要支撑位（如MA20或MA60）时，可以观察小时级别的图表是否已经出现反转信号。如果15分钟、30分钟图表已经出现KDJ金叉，而日线尚未形成金叉，这可能是一个提前介入的机会。

### 场景二：趋势确认

当小时级别图表（如60分钟图）率先突破重要阻力位时，可以观察日线图表是否也跟随突破。如果日线也随后突破，这往往是一个更为可靠的趋势信号。

### 场景三：超买/超卖判断

当某一周期的RSI指标显示股票处于超买区域时，可以对照更大的周期（如日线对比周线）。如果更大周期并未处于超买区域，则短期回调后可能仍有上升空间。

## 注意事项

1. **数据可用性**：较小周期（如15分钟）的数据可能不是对所有股票都可用，系统会自动跳过不可用的周期。
2. **指标计算**：不同周期的指标参数可能不同，请注意解读时的差异。
3. **多周期分析不等于多重确认**：不同周期反映的是不同时间尺度的市场结构，它们之间可能存在冲突，这种冲突本身也包含有价值的信息。

## 高级用法

### 自定义指标参数

系统默认使用标准参数计算各技术指标，如果需要自定义参数，可以修改`scripts/backtest/multi_period_analyzer.py`文件中的相关代码。

### 添加新的技术指标

如需添加新的技术指标，请按照以下步骤操作：

1. 在`indicators`目录下创建新的指标类
2. 在`indicators/factory.py`中注册新指标
3. 修改`scripts/backtest/multi_period_analyzer.py`中的`_analyze_period`方法，添加新指标的计算

### 导出数据用于其他分析

系统生成的JSON文件包含完整的分析数据，可以导入到其他分析工具中进一步处理。

## 常见问题

**Q: 为什么有些指标在某些周期显示为空？**  
A: 可能是因为该周期的数据量不足以计算指标，或者数据库中没有该周期的数据。

**Q: 如何判断哪个周期的信号更重要？**  
A: 一般来说，更大的周期（如日线、周线）的信号通常更为可靠，但结合多个周期的信号可以提高准确性。

**Q: 是否可以只分析某些特定周期？**  
A: 目前系统会分析所有可用周期，如需只分析特定周期，可以修改源代码进行自定义。

## 技术支持

如有任何问题或建议，请联系技术支持团队。 